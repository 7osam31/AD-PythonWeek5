"""
Day 24 Activity: Feature Selection
Tasks:
1) Load dataset
2) Apply variance threshold
3) Remove highly correlated features
4) Compare model performance before/after
"""

import pandas as pd
from sklearn.feature_selection import VarianceThreshold
import numpy as np
import seaborn as sns
import matplotlib.pyplot as plt 
# TODO: Load data from data/day24_selection.csv
df = pd.read_csv("C:\\Users\\acer57\OneDrive\Desktop\my web\python\data_day24_selection.csv")

# TODO: Apply variance threshold
selector = VarianceThreshold(threshold=0.1)
x_selector= selector.fit_transform(df)
# TODO: Drop correlated features
def drop_correlated_features(df,threshold=0.9):
    corr_matrix=df.corr().abs()
    upper=corr_matrix.where(np.triu(np.ones(corr_matrix.shape),k=1).astype(bool))
    to_drop =[col for col in upper.columns if any(upper[col]>threshold)]
    return df.drop(columns=to_drop)
plt.figure(figsize=(12,10))

corr = df.corr()

sns.heatmap(
    corr,
    annot=True,
    fmt=".2f",
    cmap="coolwarm",
    linewidths=0.5,
    vmin=-1, vmax=1,
    center=0,
    square=True,
    cbar_kws={"shrink": .8}
)

plt.title("Correlation Heatmap", fontsize=16)
plt.xticks(rotation=45)
plt.yticks(rotation=0)
plt.tight_layout()
plt.show()

plt.show()
corr_uncorr=drop_correlated_features(corr)


plt.figure(figsize=(12,10))
sns.heatmap(
    corr_uncorr,
    annot=True,
    fmt=".2f",
    cmap="coolwarm",
    linewidths=0.5,
    vmin=-1, vmax=1,
    center=0,
    square=True
)
plt.title("After Removing Correlated Features")
plt.xticks(rotation=45)
plt.tight_layout()
plt.show()
